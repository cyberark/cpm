---

- hosts: cpm
  gather_facts: no
  tasks:

    - name: download package from s3
      aws_s3:
        bucket: cloud-initiatives-pipeline-bucket
        object: "Packages/v11.1/Central Policy Manager-Rls-v11.1.zip"
        dest: "/tmp/cpm.zip"
        mode: get
      delegate_to: localhost

    - name: CPM Deployment
      include_role:
        name: cpm
      vars:
        - cpm_extract: true
        - cpm_prerequisites: true
        - cpm_install: true
        - cpm_hardening: true
        - cpm_registration: false
        - cpm_zip_file_path: "/tmp/cpm.zip"
        - accept_eula: yes
